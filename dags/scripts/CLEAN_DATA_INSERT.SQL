execute immediate $$
begin

INSERT INTO CATEGORY (NAME)
SELECT DISTINCT CATEGORY
FROM PRODUCTS_RAW;

INSERT INTO CURRENCY (NAME)
SELECT DISTINCT CURRENCY
FROM PRODUCTS_RAW;

INSERT INTO COLOR_LABEL (NAME)
SELECT DISTINCT COLOR_LABEL
FROM PRODUCTS_RAW;

INSERT INTO CHANNEL (NAME)
SELECT DISTINCT CHANNEL
FROM PRODUCTS_RAW;

INSERT INTO TYPE (NAME)
SELECT DISTINCT TYPE
FROM PRODUCTS_RAW;

INSERT INTO LABEL (NAME)
SELECT DISTINCT COLOR_LABEL
FROM PRODUCTS_RAW
UNION
SELECT DISTINCT LABEL
FROM PRODUCTS_RAW;

INSERT INTO SALES (TICKET_ID, UID, CURRENCY_ID, SALES, QUANTITY, DATE)
SELECT DISTINCT TICKET_ID, UID, CURRENCY.ID, SALES, QUANTITY, DATE
FROM SALES_RAW
INNER JOIN CURRENCY ON CURRENCY.NAME = SALES_RAW.CURRENCY;

INSERT INTO PRODUCTS (UID
    ,CLOUD_PROD_ID
    ,PRODUCT_ID
    ,TITLE
    ,SUBTITLE
    ,SHORT_ID
    ,COLOR_NUM
    ,CATEGORY_ID
    ,TYPE_ID
    ,CURRENCY_ID
    ,FULL_PRICE
    ,CURRENT_PRICE
    ,SALE
    ,TOPCOLOR
    ,CHANNEL_ID
    ,SHORT_DESCRIPTION
    ,RATING
    ,CUSTOMIZABLE
    ,EXTENDED_SIZING
    ,IN_STOCK
    ,COMING_SOON
    ,BEST_SELLER
    ,EXCLUDED
    ,GIFT_CARD
    ,JERSEY
    ,LAUNCH
    ,MEMBER_EXCLUSIVE
    ,NBA
    ,NFL
    ,SUSTAINABLE
    ,LABEL_ID
    ,PREBUILD_ID
    ,PROD_URL
    ,COLOR_ID
    ,COLOR_DESCRIPTION
    ,COLOR_FULLPRICE
    ,COLOR_CURRENTPRICE
    ,COLOR_DISCOUNT
    ,COLOR_BESTSELLER
    ,COLOR_IN_STOCK
    ,COLOR_MEMBER_EXCLUSIVE
    ,COLOR_NEW
    ,COLOR_LABEL_ID
    ,COLOR_IMAGE_URL)
SELECT DISTINCT
     PR.UID
    ,PR.CLOUDPRODID
    ,PR.PRODUCTID
    ,PR.TITLE
    ,PR.SUBTITLE
    ,PR.SHORTID
    ,PR.COLORNUM
    ,CA.ID
    ,TY.ID
    ,CU.ID
    ,PR.FULLPRICE
    ,PR.CURRENTPRICE
    ,TO_BOOLEAN(PR.SALE)
    ,PR.TOPCOLOR
    ,CH.ID
    ,PR.SHORT_DESCRIPTION
    ,PR.RATING
    ,TO_BOOLEAN(PR.CUSTOMIZABLE)
    ,TO_BOOLEAN(PR.EXTENDEDSIZING)
    ,TO_BOOLEAN(PR.INSTOCK)
    ,TO_BOOLEAN(PR.COMINGSOON)
    ,TO_BOOLEAN(PR.BESTSELLER)
    ,TO_BOOLEAN(PR.EXCLUDED)
    ,TO_BOOLEAN(PR.GIFTCARD)
    ,TO_BOOLEAN(PR.JERSEY)
    ,TO_BOOLEAN(PR.LAUNCH)
    ,TO_BOOLEAN(PR.MEMBEREXCLUSIVE)
    ,TO_BOOLEAN(PR.NBA)
    ,TO_BOOLEAN(PR.NFL)
    ,TO_BOOLEAN(PR.SUSTAINABLE)
    ,LBL.ID
    ,PR.PREBUILDID
    ,PR.PROD_URL
    ,PR.COLOR_ID
    ,PR.COLOR_DESCRIPTION
    ,PR.COLOR_FULLPRICE
    ,PR.COLOR_CURRENTPRICE
    ,TO_BOOLEAN(PR.COLOR_DISCOUNT)
    ,TO_BOOLEAN(PR.COLOR_BESTSELLER)
    ,TO_BOOLEAN(PR.COLOR_INSTOCK)
    ,TO_BOOLEAN(PR.COLOR_MEMBEREXCLUSIVE)
    ,TO_BOOLEAN(PR.COLOR_NEW)
    ,CLB.ID
    ,PR.COLOR_IMAGE_URL
FROM PRODUCTS_RAW PR
INNER JOIN CATEGORY CA ON CA.NAME = PR.CATEGORY
INNER JOIN TYPE TY ON PR.TYPE = TY.NAME
INNER JOIN CURRENCY CU ON PR.CURRENCY = CU.NAME
INNER JOIN CHANNEL CH ON PR.CHANNEL = CH.NAME
INNER JOIN LABEL LBL ON PR.LABEL = LBL.NAME
INNER JOIN LABEL CLB ON PR.COLOR_LABEL = CLB.NAME;

end;
$$